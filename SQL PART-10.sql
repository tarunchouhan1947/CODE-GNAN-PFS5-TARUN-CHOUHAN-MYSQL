USE HELLO;

CREATE TABLE EMP12345(
	ID INT PRIMARY KEY AUTO_INCREMENT,
    EMP_NAME VARCHAR(30),
    EMP_SAL BIGINT
);

INSERT INTO EMP12345 (EMP_NAME,EMP_SAL) VALUES ("SAI 1",10000),("SAI 2",10000),("SAI 3",20000),("SAI 4",30000),("SAI 5",50000);

SELECT * FROM EMP12345;

-- COUNT
SELECT COUNT(EMP_SAL) FROM EMP12345;
SELECT COUNT(EMP_SAL) FROM EMP12345 WHERE EMP_SAL = 10000;

-- SUM
SELECT SUM(EMP_SAL) FROM EMP12345;
SELECT SUM(EMP_SAL) FROM EMP12345 WHERE EMP_SAL = 10000;
SELECT * FROM EMP12345;
SELECT SUM(EMP_SAL) FROM EMP12345 WHERE (ID%2=0);

-- AVG
SELECT AVG(EMP_SAL) FROM EMP12345;
SELECT * FROM EMP12345;
SELECT AVG(EMP_SAL) FROM EMP12345 WHERE EMP_SAL>20000;

-- MIN
SELECT MIN(EMP_SAL) FROM EMP12345;

-- MAX
SELECT MAX(EMP_SAL) FROM EMP12345;

-- DISTINCT
SELECT DISTINCT EMP_SAL FROM EMP12345;

CREATE TABLE EMP1234(
	ID INT PRIMARY KEY AUTO_INCREMENT,
    EMP_NAME VARCHAR(30),
    EMP_SAL BIGINT,
    DEPT_ID INT 
);

INSERT INTO EMP1234 (EMP_NAME,EMP_SAL,DEPT_ID) VALUES ("SAI 1",10000,101),("SAI 2",20000,101);
INSERT INTO EMP1234 (EMP_NAME,EMP_SAL,DEPT_ID) VALUES ("SAI 3",30000,102),("SAI 4",40000,102);
INSERT INTO EMP1234 (EMP_NAME,EMP_SAL,DEPT_ID) VALUES ("SAI 5",15000,103),("SAI 6",25000,103),("SAI 7",45000,103);
INSERT INTO EMP1234 (EMP_NAME,EMP_SAL,DEPT_ID) VALUES ("SAI 8",40000,104);
INSERT INTO EMP1234 (EMP_NAME,EMP_SAL,DEPT_ID) VALUES ("SVI 1",46000,104),("VARDAHN",70000,104);
-- GROUP BY
SELECT * FROM EMP1234;
SELECT COUNT(EMP_SAL) FROM EMP1234 WHERE DEPT_ID=103;
SELECT DEPT_ID,COUNT(*) FROM EMP1234 GROUP BY DEPT_ID;
SELECT DEPT_ID,MAX(EMP_SAL) FROM EMP1234 GROUP BY DEPT_ID;
SELECT EMP_SAL FROM EMP1234 GROUP BY EMP_SAL HAVING COUNT(*)>1;
-- HAVING
SELECT DEPT_ID FROM EMP1234 GROUP BY DEPT_ID HAVING COUNT(*) > 2;

SELECT DEPT_ID,COUNT(*) FROM EMP1234 WHERE EMP_NAME LIKE "%V%" GROUP BY DEPT_ID;